<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: algorithm/kekule.structures.standardizers.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: algorithm/kekule.structures.standardizers.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview
 * Standardization routines for chemical structures, especially for ctab based ones.
 * Standardization may include canonicalization, aromatic perception and so on.
 * @author Partridge Jiang
 */

/*
 * requires /lan/classes.js
 * requires /core/kekule.common.js
 * requires /core/kekule.structures.js
 * requires /core/kekule.chemUtils.js
 * requires /utils/kekule.utils.js
 * requires /algorithm/kekule.structure.canonicalizers.js
 * requires /algorithm/kekule.structure.aromatics.js
 * requires /algorithm/kekule.structure.stereos.js
 */

(function(){
"use strict";

/**
 * A helper class to standardize molecule.
 * @class
 */
Kekule.MolStandardizer = {
	/**
	 * Standardize a structure fragment (molecule).
	 * Standardization may include canonicalization, aromatic perception and so on.
	 * @param {Kekule.StructureFragment} structureFragment
	 * @param {Hash} options Standardization options, including the following fields:
	 *   {
	 *     unmarshalSubFragments: bool, whether unmarshal all sub structures cascadedly of molecule, default is true.
	 *     doCanonicalization: bool, whether do canonicalization to molecule, default is true.
	 *     canonicalizerExecutorId: string, which canonicalizer executor should be used. If this
	 *       value is not set, default one will be used instead.
	 *     doAromaticPerception: bool, whether do aromatic ring perception to molecule, default is true.
	 *     doStereoPerception: bool, whether detect and mark all stereo factors of nodes and connectors, default is true.
	 *   }.
	 */
	standardize: function(structureFragment, options)
	{
		var defOptions = {
			unmarshalSubFragments: true,
			doCanonicalization: true,
			doAromaticPerception: true,
			doStereoPerception: true
		};
		var mol = structureFragment;
		var op = Object.extend(defOptions, options);
		if (op.unmarshalSubFragments)
			mol.unmarshalAllSubFragments(true);
		if (op.doCanonicalization)
			Kekule.canonicalizer.canonicalize(mol, op.canonicalizerExecutorId || null);
		if (op.doAromaticPerception)
		{
			mol.perceiveAromaticRings();
			//console.log('perceive aromatics');
		}
		if (op.doStereoPerception)
			mol.perceiveStereos(null, true);  // already canonicalized, no need to do again, what's more, canonicalization may clear the ring info already perceived

		return mol;
	}
};

Object.extend(Kekule.ChemStructureUtils,
/** @lends Kekule.ChemStructureUtils */
{
	/**
	 * Check if two structure fragment (molecule) is same in chem level (same
	 * atoms, bonds and structures).
	 * @param {Kekule.StructureFragment} mol1
	 * @param {Kekule.StructureFragment} mol2
	 * @param {Hash} compareOptions
	 * @returns {Bool}
	 */
	isSameStructure: function(mol1, mol2, compareOptions)
	{
		// clone the structure to avoid change original molecule objects
		var m1 = mol1.clone(false);
		var m2 = mol2.clone(false);
		// standardize each
		m1 = Kekule.MolStandardizer.standardize(m1);
		m2 = Kekule.MolStandardizer.standardize(m2);
		// compare options
		var op = compareOptions || {}; //Object.extend(compareOptions || {});
		// compare
		return Kekule.UnivChemStructObjComparer.compare(m1, m2, op) === 0;
	}
});

ClassEx.extend(Kekule.ChemObject,
/** @lends Kekule.ChemObject# */
{
	/**
	 * Standardize this structure fragment (molecule).
	 * Standardization may include canonicalization, aromatic perception and so on.
	 * @param {Hash} options Standardization options, including the following fields:
	 *   {
	 *     unmarshalSubFragments: bool, whether unmarshal all sub structures cascadedly of molecule, default is true.
	 *     doCanonicalization: bool, whether do canonicalization to molecule, default is true.
	 *     canonicalizerExecutorId: string, which canonicalizer executor should be used. If this
	 *       value is not set, default one will be used instead.
	 *     doAromaticPerception: bool, whether do aromatic ring perception to molecule, default is true.
	 *   }.
	 */
	standardize: function(options)
	{
		// find out all molecule
		var mols = Kekule.ChemStructureUtils.getAllStructFragments(this, true);
		for (var i = 0, l = mols.length; i &lt; l; ++i)
		{
			mols[i].standardize(options);
		}
		return this;
	}
});
ClassEx.extend(Kekule.StructureFragment,
/** @lends Kekule.StructureFragment# */
{
	/**
	 * Standardize this structure fragment (molecule).
	 * Standardization may include canonicalization, aromatic perception and so on.
	 * @param {Hash} options Standardization options, including the following fields:
	 *   {
	 *     unmarshalSubFragments: bool, whether unmarshal all sub structures cascadedly of molecule, default is true.
	 *     doCanonicalization: bool, whether do canonicalization to molecule, default is true.
	 *     canonicalizerExecutorId: string, which canonicalizer executor should be used. If this
	 *       value is not set, default one will be used instead.
	 *     doAromaticPerception: bool, whether do aromatic ring perception to molecule, default is true.
	 *   }.
	 */
	standardize: function(options)
	{
		return Kekule.MolStandardizer.standardize(this, options);
	},
	/**
	 * Check if two structure fragment (molecule) is same in chem level (same
	 * atoms, bonds and structures).
	 * @param {Kekule.StructureFragment} target
	 * @param {Hash} compareOptions
	 * @returns {Bool}
	 */
	isSameStructureWith: function(target, compareOptions)
	{
		return Kekule.ChemStructureUtils.isSameStructure(this, target, compareOptions);
	}
});

})();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Kekule.CanonicalizationConnectorSorter.html">CanonicalizationConnectorSorter</a></li><li><a href="Kekule.CanonicalizationCustomExecutor.html">CanonicalizationCustomExecutor</a></li><li><a href="Kekule.CanonicalizationGeneralConnectorSorter.html">CanonicalizationGeneralConnectorSorter</a></li><li><a href="Kekule.CanonicalizationIndexer.html">CanonicalizationIndexer</a></li><li><a href="Kekule.CanonicalizationMorganExIndexer.html">CanonicalizationMorganExIndexer</a></li><li><a href="Kekule.CanonicalizationMorganIndexer.html">CanonicalizationMorganIndexer</a></li><li><a href="Kekule.CanonicalizationMorganNodeSorter.html">CanonicalizationMorganNodeSorter</a></li><li><a href="Kekule.CanonicalizationNodeSorter.html">CanonicalizationNodeSorter</a></li><li><a href="Kekule.Canonicalizer.html">Canonicalizer</a></li><li><a href="Kekule.ChemStructObjContainer.html">ChemStructObjContainer</a></li><li><a href="Kekule.ChemStructureSearcher.html">ChemStructureSearcher</a></li><li><a href="Kekule.Graph.html">Graph</a></li><li><a href="Kekule.GraphAdaptUtils.html">GraphAdaptUtils</a></li><li><a href="Kekule.GraphAlgorithmUtils.html">GraphAlgorithmUtils</a></li><li><a href="Kekule.GraphEdge.html">GraphEdge</a></li><li><a href="Kekule.GraphElement.html">GraphElement</a></li><li><a href="Kekule.GraphVertex.html">GraphVertex</a></li><li><a href="Kekule.MolStandardizer.html">MolStandardizer</a></li><li><a href="Kekule.MolStereoUtils.html">MolStereoUtils</a></li></ul><h3>Namespaces</h3><ul><li><a href="Kekule.html">Kekule</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$jsRoot">$jsRoot</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Mon May 04 2015 22:48:33 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
