<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/kekule.textHelper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/kekule.textHelper.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview
 * Contains classes and functions help to analysis text format chemical data,
 * especially the line/column fixed ones such as MDL MOL/SDF/RXN.
 * @author Partridge Jiang
 */


/*
 * requires /lan/classes.js
 * requires /lan/xmlJsons.js
 * requires /core/kekule.common.js
 * requires /localization
 */

/**
 * A helper class to read / write text data organized in lines.
 * @class
 * @augments ObjectEx
 * @param {Variant} textOrLines A pack of text (String) or lines (Array) to read.
 *
 * @property {String} text Text data to handle.
 * @property {Array} lines Each item is a line of text.
 * @property {Integer} currLineNo Which line is currently reading.
 */
Kekule.TextLinesBuffer = Class.create(ObjectEx,
/** @lends Kekule.TextLinesBuffer# */
{
	/** @private */
	CLASS_NAME: 'Kekule.TextLinesBuffer',
	/** @private */
	LINEBREAK: '\n',
	/** @constructs */
	initialize: function($super, textOrLines)
	{
		$super();
		this.setPropStoreFieldValue('lines', []);
		if (textOrLines)
		{
			if (typeof(textOrLines) == 'string')
				this.setText(textOrLines);
			else
				this.setLines(textOrLines);
		}
		this.setCurrLineNo(0);
	},
	/** @private */
	initProperties: function()
	{
		this.defineProp('lines', {'dataType': DataType.ARRAY, 'serializable': false});
		this.defineProp('text', {
			'dataType': DataType.STRING,
			'serializable': false,
			'getter': function()
				{
					return this.getLines().join(this.LINEBREAK);
				},
			'setter': function(value)
				{
					this.setPropStoreFieldValue('lines', []);
					this.reset();
					this.appendText(value);
				}
		});

		this.defineProp('currLineNo', {'dataType': DataType.INT, 'serializable': false});
	},
	/**
	 * Get lines unread (below currLinNo).
	 * @returns {String}
	 */
	getUnreadLines: function()
	{
		var lines = [].concat(this.getLines());
		lines.splice(0, this.getCurrLineNo());
		return lines;
	},
	/**
	 * Get text unread (below currLinNo).
	 * @returns {String}
	 */
	getUnreadText: function()
	{
		return this.getUnreadLines().join(this.LINEBREAK);
	},
	/**
	 * Append text to current one.
	 * @param {String} text
	 */
	appendText: function(text)
	{
		var lines = text.split(this.LINEBREAK);
		this.appendLines(lines);
	},
	/**
	 * Append lines of text to current one.
	 * @param {Array} lines
	 */
	appendLines: function(lines)
	{
		this.setPropStoreFieldValue('lines', this.getLines().concat(lines));
		this.notifyPropSet('lines', this.getPropStoreFieldValue('lines'));
	},
	/**
	 * Clear text and lines.
	 */
	clear: function()
	{
		this.setLines([]);
		this.setCurrLineNo(0);
	},

	// methods about line read
	/** @private */
	incCurrLineNo: function(count)
	{
		if ((count === null) || (typeof(count) == 'undefined'))
			count = 1;
		var i = this.getCurrLineNo();
		i += count;
		this.setCurrLineNo(i);
	},
	/**
	 * Get value of line in index.
	 * @param {Int} index
	 * @returns {String}
	 */
	getLineAt: function(index)
	{
		var s = this.getLines()[index];
		if (s &amp;&amp; s.length &amp;&amp; (s.charAt(s.length - 1) === '\r'))   // may has '\r' hangling
			s = s.substring(0, s.length - 1);
		return s;
	},
	/**
	 * Get value of current line but not move currLineNo to next line.
	 * @returns {String}
	 */
	getCurrLine: function()
	{
		return this.getLineAt(this.getCurrLineNo());
	},
	/**
	 * Get value of current line and move currLineNo to next line.
	 * @returns {String}
	 */
	readLine: function()
	{
		var r = this.getLineAt(this.getCurrLineNo());
		this.incCurrLineNo();
		return r;
	},
	/**
	 * Insert a line at current position and move currLineNo to next line.
	 * @param {String} line
	 */
	writeLine: function(line)
	{
		var lines = this.getLines();
		lines.splice(this.getCurrLineNo(), 0, line);
		this.incCurrLineNo();
	},
	/**
	 * Insert array of lines at current position and move currLineNo.
	 * @param {Array} lines
	 */
	writeLines: function(lines)
	{
		/*
		var lines = this.getLines();
		lines.splice(this.getCurrLineNo(), 0, lines);
		this.incCurrLineNo(lines.length);
		*/
		for (var i = 0, l = lines.length; i &lt; l; ++i)
			this.writeLine(lines[i]);
	},
	/**
	 * Insert text at current position and move currLineNo.
	 * Text may have line breaks.
	 * @param {String} text
	 */
	writeText: function(text)
	{
		var lines = text.split(this.LINEBREAK);
		this.writeLines(lines);
	},
	/**
	 * Check whether all lines are read and currLineNo point to end of data.
	 * @returns {Bool}
	 */
	eof: function()
	{
		return this.getCurrLineNo() >= this.getLines().length;
	},
	/**
	 * Reset currLineNo to zero (beginning of text data).
	 */
	reset: function()
	{
		this.setCurrLineNo(0);
	}
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Kekule.IO.BaseMdlReader.html">BaseMdlReader</a></li><li><a href="Kekule.IO.BaseMdlWriter.html">BaseMdlWriter</a></li><li><a href="Kekule.IO.ChemDataReader.html">ChemDataReader</a></li><li><a href="Kekule.IO.ChemDataReaderManager.html">ChemDataReaderManager</a></li><li><a href="Kekule.IO.ChemDataType.html">ChemDataType</a></li><li><a href="Kekule.IO.ChemDataWriter.html">ChemDataWriter</a></li><li><a href="Kekule.IO.ChemDataWriterManager.html">ChemDataWriterManager</a></li><li><a href="Kekule.IO.CmlChemStructureReader.html">CmlChemStructureReader</a></li><li><a href="Kekule.IO.CmlDomUtils.html">CmlDomUtils</a></li><li><a href="Kekule.IO.CmlElementHandler.html">CmlElementHandler</a></li><li><a href="Kekule.IO.CmlElementReader.html">CmlElementReader</a></li><li><a href="Kekule.IO.CmlElementReaderFactory.html">CmlElementReaderFactory</a></li><li><a href="Kekule.IO.CmlElementWriter.html">CmlElementWriter</a></li><li><a href="Kekule.IO.CmlElementWriterFactory.html">CmlElementWriterFactory</a></li><li><a href="Kekule.IO.CmlFormulaReader.html">CmlFormulaReader</a></li><li><a href="Kekule.IO.CmlFormulaWriter.html">CmlFormulaWriter</a></li><li><a href="Kekule.IO.CmlListReader.html">CmlListReader</a></li><li><a href="Kekule.IO.CmlListWriter.html">CmlListWriter</a></li><li><a href="Kekule.IO.CmlMetaDataListReader.html">CmlMetaDataListReader</a></li><li><a href="Kekule.IO.CmlMetaDataReader.html">CmlMetaDataReader</a></li><li><a href="Kekule.IO.CmlMoleculeReader.html">CmlMoleculeReader</a></li><li><a href="Kekule.IO.CmlMoleculeWriter.html">CmlMoleculeWriter</a></li><li><a href="Kekule.IO.CmlNameReader.html">CmlNameReader</a></li><li><a href="Kekule.IO.CmlReactionReader.html">CmlReactionReader</a></li><li><a href="Kekule.IO.CmlReactionReagentReader.html">CmlReactionReagentReader</a></li><li><a href="Kekule.IO.CmlReactionWriter.html">CmlReactionWriter</a></li><li><a href="Kekule.IO.CmlReader.html">CmlReader</a></li><li><a href="Kekule.IO.CmlRootReader.html">CmlRootReader</a></li><li><a href="Kekule.IO.CmlRootWriter.html">CmlRootWriter</a></li><li><a href="Kekule.IO.CmlScalarReader.html">CmlScalarReader</a></li><li><a href="Kekule.IO.CmlScalarWriter.html">CmlScalarWriter</a></li><li><a href="Kekule.IO.CmlUtils.html">CmlUtils</a></li><li><a href="Kekule.IO.CmlWriter.html">CmlWriter</a></li><li><a href="Kekule.IO.DataFormat.html">DataFormat</a></li><li><a href="Kekule.IO.DataFormatsManager.html">DataFormatsManager</a></li><li><a href="Kekule.IO.KcjReader.html">KcjReader</a></li><li><a href="Kekule.IO.KcjWriter.html">KcjWriter</a></li><li><a href="Kekule.IO.KcxReader.html">KcxReader</a></li><li><a href="Kekule.IO.KcxWriter.html">KcxWriter</a></li><li><a href="Kekule.IO.MDL.html">MDL</a></li><li><a href="Kekule.IO.Mdl2kCTabWriter.html">Mdl2kCTabWriter</a></li><li><a href="Kekule.IO.Mdl3kCTabWriter.html">Mdl3kCTabWriter</a></li><li><a href="Kekule.IO.Mdl3kMoleculeCTabWriter.html">Mdl3kMoleculeCTabWriter</a></li><li><a href="Kekule.IO.MdlBlockHandler.html">MdlBlockHandler</a></li><li><a href="Kekule.IO.MdlBlockReader.html">MdlBlockReader</a></li><li><a href="Kekule.IO.MdlBlockWriter.html">MdlBlockWriter</a></li><li><a href="Kekule.IO.MdlMoleculeReader.html">MdlMoleculeReader</a></li><li><a href="Kekule.IO.MdlMoleculeWriter.html">MdlMoleculeWriter</a></li><li><a href="Kekule.IO.MdlMolReader.html">MdlMolReader</a></li><li><a href="Kekule.IO.MdlMolWriter.html">MdlMolWriter</a></li><li><a href="Kekule.IO.MdlReactionReader.html">MdlReactionReader</a></li><li><a href="Kekule.IO.MdlReactionWriter.html">MdlReactionWriter</a></li><li><a href="Kekule.IO.MdlReader.html">MdlReader</a></li><li><a href="Kekule.IO.MdlRxnReader.html">MdlRxnReader</a></li><li><a href="Kekule.IO.MdlRxnWriter.html">MdlRxnWriter</a></li><li><a href="Kekule.IO.MdlSdReader.html">MdlSdReader</a></li><li><a href="Kekule.IO.MdlSdWriter.html">MdlSdWriter</a></li><li><a href="Kekule.IO.MdlStructDataWriter.html">MdlStructDataWriter</a></li><li><a href="Kekule.IO.MdlStructureFragmentReader.html">MdlStructureFragmentReader</a></li><li><a href="Kekule.IO.MdlStructureFragmentWriter.html">MdlStructureFragmentWriter</a></li><li><a href="Kekule.IO.MdlUtils.html">MdlUtils</a></li><li><a href="Kekule.IO.MdlWriter.html">MdlWriter</a></li><li><a href="Kekule.IO.MimeType.html">MimeType</a></li><li><a href="Kekule.IO.SMILES.html">SMILES</a></li><li><a href="Kekule.IO.SmilesMolWriter.html">SmilesMolWriter</a></li><li><a href="Kekule.IO.SmilesUtils.html">SmilesUtils</a></li><li><a href="Kekule.Mdl3kTextBuffer.html">Mdl3kTextBuffer</a></li><li><a href="Kekule.TextLinesBuffer.html">TextLinesBuffer</a></li></ul><h3>Namespaces</h3><ul><li><a href="Kekule.html">Kekule</a></li><li><a href="Kekule.IO.html">IO</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Mon Nov 26 2018 21:11:32 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
